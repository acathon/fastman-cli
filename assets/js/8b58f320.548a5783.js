"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[277],{4453:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>m,frontMatter:()=>i,metadata:()=>n,toc:()=>o});const n=JSON.parse('{"id":"concepts/database","title":"Database & Migrations","description":"Fastman uses SQLAlchemy for the ORM and Alembic for migrations.","source":"@site/docs/concepts/database.md","sourceDirName":"concepts","slug":"/concepts/database","permalink":"/fastman-cli/docs/concepts/database","draft":false,"unlisted":false,"editUrl":"https://github.com/acathon/fastman-cli/tree/main/docs/docs/concepts/database.md","tags":[],"version":"current","lastUpdatedAt":1770580452000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Architecture Examples","permalink":"/fastman-cli/docs/concepts/examples"},"next":{"title":"Authentication","permalink":"/fastman-cli/docs/concepts/authentication"}}');var t=a(4848),r=a(8453);const i={sidebar_position:3},d="Database & Migrations",l={},o=[{value:"Supported Databases",id:"supported-databases",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Models",id:"models",level:2},{value:"Migrations",id:"migrations",level:2},{value:"Create a Migration",id:"create-a-migration",level:3},{value:"Run Migrations",id:"run-migrations",level:3},{value:"Rollback",id:"rollback",level:3},{value:"Seeders",id:"seeders",level:2},{value:"Create a Seeder",id:"create-a-seeder",level:3},{value:"Run Seeders",id:"run-seeders",level:3},{value:"Factories",id:"factories",level:2}];function c(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"database--migrations",children:"Database & Migrations"})}),"\n",(0,t.jsx)(s.p,{children:"Fastman uses SQLAlchemy for the ORM and Alembic for migrations."}),"\n",(0,t.jsx)(s.h2,{id:"supported-databases",children:"Supported Databases"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Database"}),(0,t.jsx)(s.th,{children:"Connection String"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"SQLite"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"sqlite:///./app.db"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"PostgreSQL"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"postgresql://user:pass@host:5432/db"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"MySQL"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"mysql+pymysql://user:pass@host:3306/db"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Oracle"}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"oracle+cx_oracle://user:pass@host:1521/db"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Firebase"}),(0,t.jsx)(s.td,{children:"Custom integration (no Alembic)"})]})]})]}),"\n",(0,t.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(s.p,{children:["Set your database URL in ",(0,t.jsx)(s.code,{children:".env"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-env",children:"DATABASE_URL=postgresql://postgres:password@localhost:5432/myapp\n"})}),"\n",(0,t.jsx)(s.h2,{id:"models",children:"Models"}),"\n",(0,t.jsxs)(s.p,{children:["Create models with ",(0,t.jsx)(s.code,{children:"make:model"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"fastman make:model post\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'# app/features/post/models.py\nfrom sqlalchemy import Column, Integer, String, Text, DateTime\nfrom sqlalchemy.sql import func\nfrom app.core.database import Base\n\nclass Post(Base):\n    __tablename__ = "posts"\n\n    id = Column(Integer, primary_key=True, index=True)\n    title = Column(String(200), nullable=False)\n    content = Column(Text)\n    created_at = Column(DateTime, server_default=func.now())\n    updated_at = Column(DateTime, onupdate=func.now())\n'})}),"\n",(0,t.jsx)(s.h2,{id:"migrations",children:"Migrations"}),"\n",(0,t.jsx)(s.h3,{id:"create-a-migration",children:"Create a Migration"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'fastman make:migration "create posts table"\n'})}),"\n",(0,t.jsxs)(s.p,{children:["This generates a timestamped migration in ",(0,t.jsx)(s.code,{children:"database/migrations/versions/"}),"."]}),"\n",(0,t.jsx)(s.h3,{id:"run-migrations",children:"Run Migrations"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Apply all pending migrations\nfastman database:migrate\n\n# Check current status\nfastman migrate:status\n"})}),"\n",(0,t.jsx)(s.h3,{id:"rollback",children:"Rollback"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Rollback last migration\nfastman migrate:rollback\n\n# Rollback multiple\nfastman migrate:rollback --steps=3\n\n# Reset everything (danger!)\nfastman migrate:reset\n"})}),"\n",(0,t.jsx)(s.h2,{id:"seeders",children:"Seeders"}),"\n",(0,t.jsx)(s.p,{children:"Populate your database with initial or test data."}),"\n",(0,t.jsx)(s.h3,{id:"create-a-seeder",children:"Create a Seeder"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"fastman make:seeder user\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'# database/seeders/user_seeder.py\nfrom app.features.user.models import User\nfrom passlib.hash import bcrypt\n\nclass UserSeeder:\n    @staticmethod\n    def run(db):\n        admin = User(\n            email="admin@example.com",\n            password=bcrypt.hash("password123"),\n            is_admin=True\n        )\n        db.add(admin)\n        db.commit()\n        print("Created admin user")\n'})}),"\n",(0,t.jsx)(s.h3,{id:"run-seeders",children:"Run Seeders"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Run all seeders\nfastman database:seed\n\n# Run specific seeder\nfastman database:seed --class=UserSeeder\n"})}),"\n",(0,t.jsx)(s.admonition,{title:"Important",type:"warning",children:(0,t.jsxs)(s.p,{children:["Always run seeder commands from your ",(0,t.jsx)(s.strong,{children:"project root"})," directory."]})}),"\n",(0,t.jsx)(s.h2,{id:"factories",children:"Factories"}),"\n",(0,t.jsx)(s.p,{children:"Create realistic test data with Faker."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"fastman make:factory user\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'# tests/factories/user_factory.py\nfrom faker import Faker\n\nfake = Faker()\n\nclass UserFactory:\n    @staticmethod\n    def make(**kwargs):\n        return {\n            "email": kwargs.get("email", fake.email()),\n            "name": kwargs.get("name", fake.name()),\n            "password": kwargs.get("password", "testpass123"),\n        }\n    \n    @staticmethod\n    def create(db, **kwargs):\n        from app.features.user.models import User\n        user = User(**UserFactory.make(**kwargs))\n        db.add(user)\n        db.commit()\n        return user\n'})})]})}function m(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,s,a)=>{a.d(s,{R:()=>i,x:()=>d});var n=a(6540);const t={},r=n.createContext(t);function i(e){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);