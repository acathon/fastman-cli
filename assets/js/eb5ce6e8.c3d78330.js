"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[200],{4789:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"advanced/custom-commands","title":"Custom Commands","description":"Fastman allows you to extend the CLI with your own commands. This is incredibly powerful for automating tasks like cron jobs, maintenance scripts, data imports, or domain-specific operations.","source":"@site/docs/advanced/custom-commands.md","sourceDirName":"advanced","slug":"/advanced/custom-commands","permalink":"/fastman-cli/docs/advanced/custom-commands","draft":false,"unlisted":false,"editUrl":"https://github.com/acathon/fastman-cli/tree/main/docs/docs/advanced/custom-commands.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Project Commands","permalink":"/fastman-cli/docs/commands/project"},"next":{"title":"Production & Docker","permalink":"/fastman-cli/docs/advanced/production-build"}}');var r=s(4848),d=s(8453);const a={sidebar_position:1},o="Custom Commands",i={},c=[{value:"Creating a Command",id:"creating-a-command",level:2},{value:"Command Structure",id:"command-structure",level:2},{value:"The <code>signature</code>",id:"the-signature",level:3},{value:"The <code>handle</code> Method",id:"the-handle-method",level:3},{value:"Real-World Example: Pruning Inactive Users",id:"real-world-example-pruning-inactive-users",level:2},{value:"Running Your Command",id:"running-your-command",level:2},{value:"Output Helpers",id:"output-helpers",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"custom-commands",children:"Custom Commands"})}),"\n",(0,r.jsx)(n.p,{children:"Fastman allows you to extend the CLI with your own commands. This is incredibly powerful for automating tasks like cron jobs, maintenance scripts, data imports, or domain-specific operations."}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-command",children:"Creating a Command"}),"\n",(0,r.jsxs)(n.p,{children:["To create a new command, use the ",(0,r.jsx)(n.code,{children:"make:command"})," generator:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fastman make:command {Name}\n"})}),"\n",(0,r.jsx)(n.p,{children:"For example, to create a command that cleans up inactive users:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fastman make:command PruneUsers\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This will generate a file at ",(0,r.jsx)(n.code,{children:"app/console/commands/prune_users.py"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"command-structure",children:"Command Structure"}),"\n",(0,r.jsxs)(n.p,{children:["A command is a Python class decorated with ",(0,r.jsx)(n.code,{children:"@register"})," that inherits from ",(0,r.jsx)(n.code,{children:"Command"}),". It must implement a ",(0,r.jsx)(n.code,{children:"handle"})," method."]}),"\n",(0,r.jsxs)(n.h3,{id:"the-signature",children:["The ",(0,r.jsx)(n.code,{children:"signature"})]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"signature"})," property defines how your command is called from the CLI. It supports arguments and options."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Command Name"}),": The first part of the signature (e.g., ",(0,r.jsx)(n.code,{children:"email:send"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Arguments"}),": Required parameters enclosed in braces (e.g., ",(0,r.jsx)(n.code,{children:"{user}"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Options"}),": Optional parameters prefixed with ",(0,r.jsx)(n.code,{children:"--"})," (e.g., ",(0,r.jsx)(n.code,{children:"{--dry-run}"}),"). You can also specify defaults (e.g., ",(0,r.jsx)(n.code,{children:"{--days=30}"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"the-handle-method",children:["The ",(0,r.jsx)(n.code,{children:"handle"})," Method"]}),"\n",(0,r.jsxs)(n.p,{children:["This is the entry point of your command. Inside ",(0,r.jsx)(n.code,{children:"handle"}),", you can access:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.argument(index)"}),": Get a positional argument."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.option(name, default)"}),": Get a named option."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.flag(name)"}),": Check if a boolean flag is present."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"self.context"}),": Access project context (root path, package manager)."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"real-world-example-pruning-inactive-users",children:"Real-World Example: Pruning Inactive Users"}),"\n",(0,r.jsx)(n.p,{children:"Let's build a command that deletes users who haven't logged in for a certain number of days."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"File"}),": ",(0,r.jsx)(n.code,{children:"app/console/commands/prune_users.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from datetime import datetime, timedelta\nfrom fastman.cli import Command, register, Output\nfrom app.core.database import SessionLocal\nfrom app.models.user import User\n\n@register\nclass PruneUsersCommand(Command):\n    """\n    Delete users who haven\'t logged in for X days.\n    \n    Usage:\n        fastman users:prune {--days=30} {--dry-run}\n    """\n    \n    # Signature defines the command name and options\n    signature = "users:prune {--days=30} {--dry-run}"\n    description = "Delete inactive users"\n    \n    def handle(self):\n        # 1. Parse options\n        days = int(self.option("days", "30"))\n        dry_run = self.flag("dry-run")\n        \n        # 2. Calculate cutoff date\n        cutoff_date = datetime.utcnow() - timedelta(days=days)\n        \n        Output.info(f"Finding users inactive since {cutoff_date.date()}...")\n        \n        # 3. Database operations\n        db = SessionLocal()\n        try:\n            # Find users\n            query = db.query(User).filter(User.last_login < cutoff_date)\n            users_to_delete = query.all()\n            count = len(users_to_delete)\n            \n            if count == 0:\n                Output.success("No inactive users found.")\n                return\n\n            # Display users to be deleted\n            rows = [[str(u.id), u.email, str(u.last_login)] for u in users_to_delete]\n            Output.table(["ID", "Email", "Last Login"], rows, title="Inactive Users")\n            \n            # 4. Confirm and Execute\n            if dry_run:\n                Output.info(f"[DRY RUN] Would delete {count} users.")\n                return\n            \n            if Output.confirm(f"Are you sure you want to delete {count} users?"):\n                # Bulk delete for efficiency\n                query.delete(synchronize_session=False)\n                db.commit()\n                Output.success(f"Successfully deleted {count} users.")\n            else:\n                Output.info("Operation cancelled.")\n                \n        except Exception as e:\n            Output.error(f"An error occurred: {e}")\n            db.rollback()\n        finally:\n            db.close()\n'})}),"\n",(0,r.jsx)(n.h2,{id:"running-your-command",children:"Running Your Command"}),"\n",(0,r.jsx)(n.p,{children:"Once you save the file, Fastman automatically discovers it."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List commands to see it registered\nfastman list\n\n# Run help (if you implemented it, or just run it)\nfastman users:prune --days=60 --dry-run\n"})}),"\n",(0,r.jsx)(n.h2,{id:"output-helpers",children:"Output Helpers"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"Output"})," class provides styled output methods to make your CLI tools look professional."]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'Output.info("msg")'})}),(0,r.jsx)(n.td,{children:"Prints blue informational text."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'Output.success("msg")'})}),(0,r.jsx)(n.td,{children:"Prints green success text with a checkmark."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'Output.error("msg")'})}),(0,r.jsx)(n.td,{children:"Prints red error text with an X."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'Output.warn("msg")'})}),(0,r.jsx)(n.td,{children:"Prints yellow warning text."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Output.table(headers, rows)"})}),(0,r.jsx)(n.td,{children:"Renders a formatted ASCII table."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'Output.confirm("msg")'})}),(0,r.jsx)(n.td,{children:"Prompts the user for Yes/No confirmation."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Output.banner()"})}),(0,r.jsx)(n.td,{children:"Prints the Fastman banner."})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const r={},d=t.createContext(r);function a(e){const n=t.useContext(d);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(d.Provider,{value:n},e.children)}}}]);